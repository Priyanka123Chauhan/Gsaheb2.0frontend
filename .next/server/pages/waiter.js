"use strict";(()=>{var e={};e.id=410,e.ids=[410,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8470:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>h,getStaticPaths:()=>g,getStaticProps:()=>b,reportWebVitals:()=>p,routeModule:()=>v,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>f});var s=r(7093),l=r(5244),i=r(1323),n=r(2899),d=r.n(n),o=r(3414),c=r(5489),u=e([c]);c=(u.then?(await u)():u)[0];let m=(0,i.l)(c,"default"),b=(0,i.l)(c,"getStaticProps"),g=(0,i.l)(c,"getStaticPaths"),h=(0,i.l)(c,"getServerSideProps"),x=(0,i.l)(c,"config"),p=(0,i.l)(c,"reportWebVitals"),f=(0,i.l)(c,"unstable_getStaticProps"),y=(0,i.l)(c,"unstable_getStaticPaths"),j=(0,i.l)(c,"unstable_getStaticParams"),N=(0,i.l)(c,"unstable_getServerProps"),w=(0,i.l)(c,"unstable_getServerSideProps"),v=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/waiter",pathname:"/waiter",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});a()}catch(e){a(e)}})},5489:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>m});var s=r(997),l=r(6689),i=r(5941),n=r(8253),d=r(1390),o=r(7803),c=r(6843),u=e([i]);i=(u.then?(await u)():u)[0];let b=e=>fetch(e).then(e=>e.json());function m(){let[e,t]=(0,l.useState)("take-order"),[r,a]=(0,l.useState)(""),[u,m]=(0,l.useState)([]),[g,h]=(0,l.useState)(""),[x,p]=(0,l.useState)(""),[f,y]=(0,l.useState)("All"),[j,N]=(0,l.useState)(!1),[w,v]=(0,l.useState)(null),[S,P]=(0,l.useState)({}),[_,C]=(0,l.useState)([]),[A,k]=(0,l.useState)(""),[O,T]=(0,l.useState)(null),$=e=>{let t=new Date(e),r=(0,o.I)(t,{hours:5,minutes:30});return(0,c.WU)(r,"dd/MM/yyyy, hh:mm a")},E="https://backend-valtri.onrender.com/".replace(/\/+$/,""),{data:I,error:q,isLoading:F}=(0,i.default)(`${E}/api/menu`,b),{data:G,error:L,isLoading:M,mutate:W}=(0,i.default)(`${E}/api/orders?status=pending`,b),R=["All",...new Set(I?.map(e=>e.category).filter(Boolean))],H=I?I.filter(e=>"All"===f||e.category===f).filter(e=>e.name.toLowerCase().includes(x.toLowerCase())):[],U=e=>{P(t=>({...t,[e.id]:!0})),setTimeout(()=>{P(t=>({...t,[e.id]:!1}))},1e3),m(t=>t.find(t=>t.item_id===e.id)?t.map(t=>t.item_id===e.id?{...t,quantity:(t.quantity||1)+1}:t):[...t,{item_id:e.id,name:e.name,price:e.price,category:e.category,image_url:e.image_url,quantity:1}]),N(!0)},Z=async()=>{if(!r)return v("Please enter a table number.");if(1>parseInt(r)||parseInt(r)>30)return v("Table number must be between 1 and 30.");if(0===u.length)return v("Cart is empty.");let e=0;for(;e<3;)try{v(null);let e=await fetch(`${E}/api/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_id:parseInt(r),items:u,notes:g||null}),signal:AbortSignal.timeout(3e4)}),t=await e.json();if(!e.ok||!t.id)throw Error(t.error||`HTTP ${e.status}`);m([]),a(""),h(""),N(!1),v("Order placed successfully!"),W();return}catch(t){if(3==++e){v(`Failed to place order after 3 attempts: ${t.message}`);return}await new Promise(e=>setTimeout(e,1e3))}},D=e=>{if(console.log("startEditingOrder called with order:",e),!e||!e.id||!e.items||!e.table_id){console.error("Invalid order data:",e),v("Cannot edit order: Invalid order data.");return}T({orderId:e.id,tableNumber:e.table_id,items:e.items,notes:e.notes||""}),m(e.items),a(e.table_id.toString()),h(e.notes||""),N(!0),t("pending-orders"),console.log("State after setting:",{editingOrder:{orderId:e.id,tableNumber:e.table_id,items:e.items,notes:e.notes||""},cart:e.items,tableNumber:e.table_id.toString(),orderNote:e.notes||"",isCartOpen:!0,activeTab:"pending-orders"})},J=async()=>{if(!O)return;if(0===u.length)return v("Cart is empty.");let e=0;for(;e<3;)try{v(null);let e=await fetch(`${E}/api/orders/${O.orderId}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:u,notes:g||null}),signal:AbortSignal.timeout(3e4)}),t=await e.json();if(!e.ok||!t.id)throw Error(t.error||`HTTP ${e.status}`);m([]),a(""),h(""),N(!1),T(null),v("Order updated successfully!"),W();return}catch(t){if(3==++e){v(`Failed to update order after 3 attempts: ${t.message}`);return}await new Promise(e=>setTimeout(e,1e3))}},V=A?_.filter(e=>e.table_id.toString()===A):_;return F&&M?s.jsx("div",{className:"text-center mt-10",role:"status",children:"Loading..."}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center items-center gap-2 mb",children:[s.jsx(d.Z,{className:"h-6 w-6 text-blue-500"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800","aria-label":"Waiter Interface for Gsaheb Cafe",children:"Waiter Interface - Gsaheb Cafe"}),s.jsx(d.Z,{className:"h-6 w-6 text-blue-500"})]}),(0,s.jsxs)("div",{className:"flex mb-6",children:[s.jsx("button",{className:`flex-1 py-2 px-4 rounded-l-lg ${"take-order"===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:()=>t("take-order"),children:"Take Order"}),s.jsx("button",{className:`flex-1 py-2 px-4 rounded-r-lg ${"pending-orders"===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:()=>t("pending-orders"),children:"Pending Orders"})]}),w&&(0,s.jsxs)("div",{className:"mb-4 flex flex-col items-center justify-center",role:"alert",children:[s.jsx("p",{className:`text-center ${w.includes("successfully")?"text-green-500":"text-red-500"}`,children:w}),w.includes("successfully")&&s.jsx("button",{className:"mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",onClick:()=>{window.location.reload()},children:"Refresh"})]}),"take-order"===e&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{htmlFor:"table-number",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Table Number (1–30)"}),s.jsx("input",{type:"number",id:"table-number",value:r,onChange:e=>a(e.target.value),className:"w-full p-3 rounded-lg border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 bg-white text-gray-800 placeholder-gray-400",placeholder:"Enter table number (1–30)",min:"1",max:"30",required:!0})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{htmlFor:"search-bar",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Search Menu"}),s.jsx("input",{type:"text",id:"search-bar",value:x,onChange:e=>p(e.target.value),className:"w-full p-3 rounded-lg border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 bg-white text-gray-800 placeholder-gray-400",placeholder:"Search for menu items..."})]}),s.jsx("div",{className:"mb-6 overflow-x-auto whitespace-nowrap pb-2",role:"tablist","aria-label":"Menu categories",children:s.jsx("div",{className:"flex gap-2",children:R.map(e=>s.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${f===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>y(e),role:"tab","aria-selected":f===e,children:e},e))})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",role:"region","aria-live":"polite",children:0===H.length?s.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No items found."}):H.map(e=>(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[s.jsx("img",{src:e.image_url||"https://images.unsplash.com/photo-1550547660-d9450f859349",alt:e.name,className:"w-full h-32 object-cover rounded-md mb-2"}),s.jsx("h2",{className:"font-semibold text-lg",children:e.name}),s.jsx("p",{className:"text-sm text-gray-500",children:e.category}),(0,s.jsxs)("p",{className:"text-sm font-medium",children:["₹",e.price.toFixed(2)]}),s.jsx("button",{className:`mt-2 w-full py-2 rounded-lg text-white transition-colors duration-300 ${S[e.id]?"bg-blue-500 hover:bg-blue-600":"bg-green-500 hover:bg-green-600"}`,onClick:()=>U(e),"aria-label":S[e.id]?`${e.name} added to cart`:`Add ${e.name} to cart`,children:S[e.id]?"Added":"Add to Cart"})]},e.id))}),(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("label",{htmlFor:"order-note",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Order Note (Optional)"}),s.jsx("textarea",{id:"order-note",value:g,onChange:e=>h(e.target.value),className:"w-full p-3 rounded-lg border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 bg-white text-gray-800 placeholder-gray-400",placeholder:"E.g., No onions, extra spicy",rows:"3"})]})]}),"pending-orders"===e&&s.jsx("div",{children:M?s.jsx("div",{className:"text-center mt-10",role:"status",children:"Loading pending orders..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"filter-table-number",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Filter by Table Number"}),s.jsx("input",{type:"number",id:"filter-table-number",value:A,onChange:e=>k(e.target.value),className:"w-full p-3 rounded-lg border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 bg-white text-gray-800 placeholder-gray-400",placeholder:"Enter table number (1–30)",min:"1",max:"30"})]}),s.jsx("div",{className:"space-y-4",children:0===V.length?s.jsx("p",{className:"text-center text-gray-500",children:"No pending orders."}):V.map(e=>(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold",children:["Order #",e.order_number||e.id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Table ",e.tables?.number||e.table_id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Placed on ",$(e.created_at)]}),e.notes&&(0,s.jsxs)("p",{className:"text-sm text-gray-700 mt-2",children:[s.jsx("strong",{children:"Note:"})," ",e.notes]})]}),s.jsx("h2",{className:"font-semibold text-lg mb-2",children:"Items"}),s.jsx("ul",{className:"mb-4",children:e.items.map((e,t)=>(0,s.jsxs)("li",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:[e.name," ",e.quantity>1?`x${e.quantity}`:""," ",e.note&&`(${e.note})`]}),(0,s.jsxs)("span",{children:["₹",(e.price*(e.quantity||1)).toFixed(2)]})]},t))}),(0,s.jsxs)("p",{className:"font-semibold",children:["Total: ₹",e.items.reduce((e,t)=>e+t.price*(t.quantity||1),0).toFixed(2)]}),s.jsx("button",{className:"mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",onClick:()=>D(e),"aria-label":`Edit order ${e.order_number||e.id}`,children:"Edit Order"})]},e.id))})]})}),s.jsx(n.Z,{cart:u,setCart:m,onPlaceOrder:O?J:Z,onClose:()=>{N(!1),O&&(T(null),m([]),a(""),h(""))},isOpen:j,tableNumber:r,orderNote:g,isEditing:!!O,menu:I||[]})]})}a()}catch(e){a(e)}})},5244:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},5315:e=>{e.exports=require("path")},5941:e=>{e.exports=import("swr")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[899,438,930],()=>r(8470));module.exports=a})();