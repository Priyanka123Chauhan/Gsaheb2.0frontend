(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[534],{5350:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order/[orderId]",function(){return r(1131)}])},1046:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});let s=(0,r(8967).eI)("https://oeqdlqmlhclxeelqevlc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9lcWRscW1saGNseGVlbHFldmxjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2NTQ2MTEsImV4cCI6MjA2NjIzMDYxMX0.zeTHfg41DFcGlNLPruysavXOsKHgtr5Uby-f730UWVs")},1131:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(5893),a=r(7294),l=r(1163),n=r(1046),i=r(8317),c=r(4678);function d(){var e;let t=(0,l.useRouter)(),{orderId:r}=t.query,[d,o]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),[x,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async function(){if(r)try{let{data:e,error:s}=await n.O.from("orders").select("id, order_number, created_at, table_id, items, status, tables(number)").eq("id",r).single();if(s)throw console.error("Fetch order error:",s.message),s;if("paid"===e.status){localStorage.removeItem("orderId"),t.replace("/blocked");return}o(e),u(!1)}catch(e){console.error("Fetch order failed:",e.message),h("Failed to load order. The order may not exist or you lack access."),u(!1),setTimeout(()=>{localStorage.removeItem("orderId"),t.replace("/blocked")},3e3)}})()},[r,t]),(0,a.useEffect)(()=>{if(!r)return;let e=n.O.channel("orders").on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders",filter:"id=eq.".concat(r)},e=>{"paid"===e.new.status?(localStorage.removeItem("orderId"),t.replace("/blocked")):o(e.new)}).subscribe();return()=>n.O.removeChannel(e)},[r,t]);let b=(null==d?void 0:d.items.reduce((e,t)=>e+t.price*(t.quantity||1),0))||0;if(m)return(0,s.jsx)("div",{className:"text-center mt-10",role:"status",children:"Loading order..."});if(x)return(0,s.jsxs)("div",{className:"text-center mt-10 text-red-500",role:"alert",children:[x," Redirecting..."]});if(!d)return(0,s.jsx)("div",{className:"text-center mt-10",role:"alert",children:"Order not found"});let f=(e=>{let t=new Date(e),r=(0,i.I)(t,{hours:5,minutes:30});return(0,c.WU)(r,"dd/MM/yyyy, hh:mm a")})(d.created_at);return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100 p-4",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold mb-4","aria-label":"Order Summary for Table ".concat(d.tables.number),children:["Order Summary - Table ",d.tables.number]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold",children:["Order Number: #",d.order_number||d.id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Date: ",f]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Table: ",(null===(e=d.tables)||void 0===e?void 0:e.number)||d.table_id]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-green-600 font-semibold text-lg mb-1",children:"Thank you for ordering! Please wait 15 minutes for your order to arrive."})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold text-lg mb-2",children:"Items"}),(0,s.jsx)("ul",{className:"space-y-1 mb-4",children:d.items.map((e,t)=>(0,s.jsxs)("li",{className:"flex justify-between text-gray-800",children:[(0,s.jsxs)("span",{children:[e.name," ",e.quantity>1?"x".concat(e.quantity):""]}),(0,s.jsxs)("span",{children:["₹",(e.price*(e.quantity||1)).toFixed(2)]})]},t))}),(0,s.jsxs)("p",{className:"font-semibold text-lg text-black",children:["Total: ₹",b.toFixed(2)]}),(0,s.jsx)("p",{className:"text-sm text-gray-700 mt-2",children:"Order Status: Confirmed & Food is under Preparation"}),(0,s.jsxs)("p",{className:"text-sm text-gray-700 mt-2",children:["Payment Status: ",d.status]})]}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Please contact our waiter to edit your order."})]})]})}}},function(e){e.O(0,[234,913,888,774,179],function(){return e(e.s=5350)}),_N_E=e.O()}]);